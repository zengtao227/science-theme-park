#!/usr/bin/env python3
"""
æ™ºèƒ½ä¿®å¤ç¼©è¿›ï¼š
- ä»ç¬¬ 1692 è¡Œåˆ°ç¬¬ 3696 è¡Œ
- æ‰€æœ‰è¡Œçš„ç¼©è¿›å¢åŠ  4 ä¸ªç©ºæ ¼ï¼ˆå› ä¸ºå®ƒä»¬åº”è¯¥åœ¨ EN å†…ï¼Œè€Œä¸æ˜¯åœ¨ em1_01 å†…ï¼‰
"""

import shutil

# æ–‡ä»¶è·¯å¾„
file_path = 'src/lib/i18n.ts'

# æ¢å¤ä¹‹å‰çš„å¤‡ä»½
shutil.copy2(file_path + '.before_indent_fix', file_path)
print(f"âœ… ä»å¤‡ä»½æ¢å¤: {file_path}.before_indent_fix")

# è¯»å–æ–‡ä»¶
with open(file_path, 'r', encoding='utf-8') as f:
    lines = f.readlines()

print(f"åŸå§‹æ–‡ä»¶: {len(lines)} è¡Œ")

# ç­–ç•¥ï¼šä»ç¬¬ 1692 è¡Œåˆ°ç¬¬ 3696 è¡Œä¹‹é—´çš„æ‰€æœ‰è¡Œï¼Œç¼©è¿›å‡å°‘ 4 ä¸ªç©ºæ ¼
# ä½†æ˜¯è¦ä¿æŒç›¸å¯¹ç¼©è¿›å…³ç³»
# 
# åŸæ¥çš„ç»“æ„ï¼ˆé”™è¯¯ï¼‰ï¼š
#     em1_01: {           // 4ä¸ªç©ºæ ¼
#         ...
#     },                  // 4ä¸ªç©ºæ ¼
#         sp2_03: {       // 8ä¸ªç©ºæ ¼ï¼ˆé”™è¯¯ï¼åº”è¯¥æ˜¯ 4 ä¸ªï¼‰
#             back: ...   // 12ä¸ªç©ºæ ¼ï¼ˆé”™è¯¯ï¼åº”è¯¥æ˜¯ 8 ä¸ªï¼‰
#         },              // 8ä¸ªç©ºæ ¼ï¼ˆé”™è¯¯ï¼åº”è¯¥æ˜¯ 4 ä¸ªï¼‰
#
# ä¿®å¤åçš„ç»“æ„ï¼ˆæ­£ç¡®ï¼‰ï¼š
#     em1_01: {           // 4ä¸ªç©ºæ ¼
#         ...
#     },                  // 4ä¸ªç©ºæ ¼
#     sp2_03: {           // 4ä¸ªç©ºæ ¼ï¼ˆæ­£ç¡®ï¼ï¼‰
#         back: ...       // 8ä¸ªç©ºæ ¼ï¼ˆæ­£ç¡®ï¼ï¼‰
#     },                  // 4ä¸ªç©ºæ ¼ï¼ˆæ­£ç¡®ï¼ï¼‰

start = 1691  # ç¬¬ 1692 è¡Œï¼Œç´¢å¼• 1691
end = 3695    # ç¬¬ 3696 è¡Œï¼Œç´¢å¼• 3695

fixed_count = 0
for i in range(start, end):
    if i >= len(lines):
        break
    line = lines[i]
    # æ‰€æœ‰ä»¥ç©ºæ ¼å¼€å¤´çš„è¡Œï¼Œå‡å°‘ 4 ä¸ªç©ºæ ¼
    if len(line) >= 4 and line[:4] == '    ':
        lines[i] = line[4:]
        fixed_count += 1
    elif line.strip():  # éç©ºè¡Œä½†ä¸ä»¥ 4 ä¸ªç©ºæ ¼å¼€å¤´
        # è¿™ç§æƒ…å†µä¸åº”è¯¥å‘ç”Ÿï¼Œè®°å½•ä¸€ä¸‹
        print(f"è­¦å‘Šï¼šç¬¬ {i+1} è¡Œä¸ä»¥ 4 ä¸ªç©ºæ ¼å¼€å¤´: {repr(line[:20])}")

print(f"\nâœ… ä¿®æ­£äº† {fixed_count} è¡Œçš„ç¼©è¿›")

# å†™å›æ–‡ä»¶
with open(file_path, 'w', encoding='utf-8') as f:
    f.writelines(lines)

print(f"\nâœ… ä¿®å¤å®Œæˆï¼Œæ–°æ–‡ä»¶: {len(lines)} è¡Œ")
print(f"\nğŸ” è¯·è¿è¡Œ 'npm run build' éªŒè¯ä¿®å¤")
