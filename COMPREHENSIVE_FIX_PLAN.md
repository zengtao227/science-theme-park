# 🎯 综合修复方案 - 2026年2月6日

## 📋 用户需求确认

### ✅ 用户系统需求
**场景**: 个人家庭使用
- 主要用户: 女儿自学
- 次要用户: 朋友的孩子（各自在家使用）
- **需求**: 本地存储学习记录，下次打开能看到进度

**决定**: 
- ✅ 使用 **方案2: 简单本地用户名系统**
- ✅ 首次访问输入名字
- ✅ 数据存储在浏览器localStorage
- ✅ 每个用户独立的学习记录

---

## 🔴 严重问题清单

### 1. 布局问题 - 横竖比例不当

#### 问题描述
**影响模块**: 几乎所有模块
- SM2.02 (勾股定理) - 右侧图是横向的，应该是竖向
- SM2.01 (二项式工厂) - 同样问题
- 大部分模块的监控图都是横向布局

**用户反馈**:
> "本来应该是一个竖的一个图，但是呢现在呢变成了扁的平的图，这个是非常毛的而且非常丑"

**原因分析**:
- 右侧监控区域是竖向的
- 但图形设计成了横向的
- 导致图形被压缩，看起来扁平

**解决方案**:
```
当前布局:
┌─────────────────┬──────────┐
│                 │          │
│   内容区域      │  监控图  │  ← 竖向空间
│                 │  (横向)  │  ← 图形是横的
│                 │          │
└─────────────────┴──────────┘

改进布局:
┌─────────────────┬──────────┐
│                 │          │
│   内容区域      │          │
│                 │  监控图  │  ← 竖向空间
│                 │  (竖向)  │  ← 图形改成竖的
│                 │          │
└─────────────────┴──────────┘
```

**需要修改**:
- [ ] SM2.02 - 勾股定理图形改为竖向
- [ ] SM2.01 - 二项式工厂图形改为竖向
- [ ] 审查所有模块，统一改为竖向布局

---

### 2. 图形尺寸太小

#### 问题描述
**用户反馈**:
> "整个的感觉就是太小了，看的反而不清楚"
> "那些图就感觉意义不是很大了，太小了，看不清楚"

**影响**:
- 3D图形太小
- 细节看不清
- 教学效果差

**解决方案A**: 增大图形尺寸
```typescript
// 当前
<div className="h-[400px]">

// 改为
<div className="h-[600px]">  // 增加高度
```

**解决方案B**: 可调节分界线
```
实现拖动分界线功能:
┌─────────────────┬──────────┐
│                 │          │
│   内容区域      ║  监控图  │  ← 可以拖动这条线
│                 │          │
└─────────────────┴──────────┘

用户可以:
- 向左拖 → 监控图变大
- 向右拖 → 内容区变大
```

**推荐**: 先实现方案A（简单），后续考虑方案B（复杂）

---

### 3. SM2.03 布局参考

#### 正面案例
**模块**: SM2.03 (直线导航器)

**用户反馈**:
> "那个你看就明显的就比较好一些，它就是比较竖板的"
> "甚至可以竖的更多一些"

**改进建议**:
- 图形部分更集中
- 不要太靠左边
- 充分利用竖向空间

---

### 4. 404错误

#### 问题描述
**影响模块**: SM2.01 (二项式工厂)

**用户反馈**:
> "我点击了像是工厂之后，居然什么都没有出来，是空的，说是一个404"
> "但现在我点它又出来了"

**可能原因**:
- 路由问题
- 组件加载失败
- 间歇性错误

**需要检查**:
- [ ] 路由配置是否正确
- [ ] 组件是否存在
- [ ] 是否有加载错误

---

### 5. 模块标题缺失

#### 影响模块
- SM2.07 - 无标题
- SM3.02 - 无标题
- SM3.04 - 无标题

#### 原因
i18n翻译keys缺失或未定义

#### 解决方案
检查并添加缺失的翻译keys

---

### 6. 翻译不完整

#### 问题描述
**影响模块**: SM1.02, 其他多个模块

**问题**:
- 中文界面有英文内容
- 德文界面显示英文（如 "to solve tower height"）
- 翻译覆盖不全面

#### 解决方案
- [ ] 审查所有模块的硬编码英文
- [ ] 添加完整的翻译keys
- [ ] 替换所有硬编码文本

---

## 🎓 课程内容问题

### SM1.02 四维超几何难度问题

#### 问题
**用户疑问**:
> "难道他们在初中一年级就学了那个S1.02四维超几何了吗？"
> "我想要知道这个到底是在什么地方，在他们的巴塞尔的这个数学的教材中，到底是属于哪一章"

#### 需要确认
- [ ] 查阅Basel教育局课程标准
- [ ] 确认7年级数学教学大纲
- [ ] 确认4D几何是否在课程中

#### 用户建议
> "你需要确定一下，严格按照他们的这个教学进度来"
> "如果不是在教学进度教学里面需要掌握的这些，那么你就暂时把它移到最后去"

#### 行动计划
1. 研究Basel Sekundarschule数学课程标准
2. 如果不在课程中 → 移到Gymnasium或删除
3. 如果在课程中 → 简化内容，降低难度

---

## 🌍 本地化要求

### 德语翻译标准

#### 要求
> "这里面的德文翻译都不要用方言了，全都用标准德文算了"

**实施**:
- ✅ 使用标准德语（Hochdeutsch）
- ❌ 不使用瑞士德语方言（Schweizerdeutsch）
- ✅ 适合学术/教育环境

---

### 本地化例子要求

#### 地理位置
> "尽量都是举在瑞士境内的一些例子，或者最好是贴近巴塞尔的"

**具体建议**:

#### 几何例子
- **梯形**: 使用Basel蓝色有轨电车的梯形窗
- **建筑阴影**: 使用Basel大教堂（Basler Münster）
- **距离计算**: 使用Basel地标之间的距离

#### 化学例子
> "那些化学的实验，你完全可以用诺华和裸氏的这些实验来，实验室来举例说明"

- **实验室**: Novartis实验室、Roche实验室
- **药物合成**: 制药公司的实际案例
- **化学反应**: 制药行业相关反应

#### 金融/指数例子
> "涉及到可以变成金融的方面的，那你可以用瑞士的在巴塞尔这边哪些银行"

- **复利计算**: 瑞士银行（UBS, Credit Suisse）
- **指数增长**: Basel银行的储蓄账户
- **百分比**: 瑞士法郎汇率

#### 物理例子
- **摆动**: Basel钟楼的钟摆
- **能量**: Rhine河水力发电
- **力学**: Basel有轨电车的运动

---

## 📐 具体改进清单

### 布局改进

#### 1. 统一竖向布局
```
优先级: 🔴 高
时间: 2-3天

需要修改的模块:
- SM2.02 (勾股定理)
- SM2.01 (二项式工厂)
- SM3.02 (三角函数) - 圆形放大
- 其他所有横向布局的模块

改进方向:
- 图形改为竖向比例
- 充分利用竖向空间
- 图形更集中，不要太靠边
```

#### 2. 增大图形尺寸
```
优先级: 🔴 高
时间: 1天

方法:
- 增加canvas/div高度
- 调整3D相机视角
- 优化图形比例

目标:
- 图形清晰可见
- 细节容易观察
- 教学效果更好
```

#### 3. 可调节分界线（可选）
```
优先级: 🟡 中
时间: 2-3天

功能:
- 用户可以拖动左右分界线
- 调整内容区和监控区比例
- 保存用户偏好设置

技术:
- React状态管理
- 鼠标拖动事件
- localStorage保存
```

---

### 翻译改进

#### 1. 修复缺失标题
```
优先级: 🔴 高
时间: 1小时

模块:
- SM2.07 → 添加 sm2_07_title
- SM3.02 → 添加 sm3_02_title
- SM3.04 → 添加 sm3_04_title

位置: src/lib/i18n.ts
```

#### 2. 完善模块内翻译
```
优先级: 🔴 高
时间: 2-3天

步骤:
1. 审查每个模块的硬编码文本
2. 提取所有英文文本
3. 添加到i18n.ts
4. 替换为翻译函数调用
5. 验证三种语言（EN/CN/DE）

重点模块:
- SM1.02 (四维几何)
- SM2.02 (勾股定理)
- 所有有硬编码文本的模块
```

#### 3. 标准德语审查
```
优先级: 🟡 中
时间: 1-2天

任务:
- 审查所有德语翻译
- 移除方言表达
- 使用标准德语（Hochdeutsch）
- 确保学术准确性
```

---

### 本地化改进

#### 1. Basel地标例子
```
优先级: 🟡 中
时间: 2-3天

需要更新的模块:
- 几何模块 → Basel建筑
- 物理模块 → Rhine河、有轨电车
- 化学模块 → Novartis/Roche
- 数学模块 → Basel银行、地标

具体例子:
SM1.01 (面积体积):
- 梯形 → Basel有轨电车窗户
- 圆柱 → Basel大教堂塔楼

SM2.02 (勾股定理):
- 建筑高度 → Basel大教堂
- 距离计算 → Basel地标间距离

SM3.03 (指数增长):
- 复利 → UBS/Credit Suisse
- 人口增长 → Basel人口统计
```

---

### 课程内容审查

#### 1. SM1.02 难度确认
```
优先级: 🔴 高
时间: 1天研究 + 1天调整

步骤:
1. 查阅Basel教育局课程标准
2. 确认7年级数学大纲
3. 决定处理方式:
   - 选项A: 移到Gymnasium
   - 选项B: 简化内容
   - 选项C: 删除模块

资源:
- Basel教育局网站
- Sekundarschule数学教材
- 教师咨询（如果可能）
```

#### 2. 全面课程对齐
```
优先级: 🟡 中
时间: 3-5天

任务:
- 审查所有模块的难度
- 对照Basel课程标准
- 调整模块顺序和难度
- 确保符合教学进度

输出:
- 更新的课程计划
- 难度分级调整
- 教学顺序优化
```

---

### 用户系统实现

#### 简单本地用户名系统
```
优先级: 🟢 低（但重要）
时间: 1-2天

功能:
1. 首次访问弹窗输入名字
2. 存储在localStorage
3. 每个用户独立数据
4. 可以切换用户

实现:
// 首次访问
if (!localStorage.getItem("currentUser")) {
  const name = prompt("请输入你的名字");
  localStorage.setItem("currentUser", name);
}

// 数据结构
{
  "currentUser": "小明",
  "users": {
    "小明": {
      history: [...],
      achievements: [...],
      progress: {...}
    },
    "小红": {
      history: [...],
      achievements: [...],
      progress: {...}
    }
  }
}

// 切换用户功能
- 设置页面添加"切换用户"按钮
- 显示当前用户名
- 可以添加新用户
```

---

## 📊 优先级和时间表

### 第1周（立即开始）

#### Day 1-2: 紧急修复
- [ ] 修复模块标题缺失（SM2.07, SM3.02, SM3.04）
- [ ] 修复404错误（SM2.01）
- [ ] 研究Basel课程标准（SM1.02）

#### Day 3-4: 布局改进
- [ ] SM2.02 改为竖向布局
- [ ] SM2.01 改为竖向布局
- [ ] SM3.02 圆形放大

#### Day 5-7: 翻译完善
- [ ] 审查所有硬编码英文
- [ ] 添加缺失的翻译keys
- [ ] 验证三语翻译

---

### 第2周: 全面优化

#### Day 1-3: 布局统一
- [ ] 审查所有模块布局
- [ ] 统一改为竖向布局
- [ ] 增大图形尺寸

#### Day 4-5: 本地化
- [ ] 添加Basel地标例子
- [ ] 更新化学模块（Novartis/Roche）
- [ ] 更新金融例子（瑞士银行）

#### Day 6-7: 用户系统
- [ ] 实现简单用户名系统
- [ ] 测试多用户切换
- [ ] 优化用户体验

---

### 第3周: 精细化

#### Day 1-3: 课程对齐
- [ ] 全面审查课程难度
- [ ] 调整模块顺序
- [ ] 更新课程计划

#### Day 4-5: 德语审查
- [ ] 审查所有德语翻译
- [ ] 改为标准德语
- [ ] 专业术语校对

#### Day 6-7: 测试和优化
- [ ] 全面测试所有模块
- [ ] 修复发现的问题
- [ ] 性能优化

---

## 🎯 成功标准

### 布局
- ✅ 所有监控图都是竖向布局
- ✅ 图形清晰可见，尺寸合适
- ✅ 布局美观，不显得"扁平"

### 翻译
- ✅ 所有模块都有标题
- ✅ 无硬编码英文文本
- ✅ 三语翻译完整准确
- ✅ 德语使用标准德语

### 本地化
- ✅ 例子都使用Basel/瑞士背景
- ✅ 化学用Novartis/Roche
- ✅ 金融用瑞士银行
- ✅ 地理用Basel地标

### 课程
- ✅ 符合Basel教育标准
- ✅ 难度适合目标年级
- ✅ 教学顺序合理

### 用户系统
- ✅ 可以输入用户名
- ✅ 学习记录独立保存
- ✅ 可以切换用户
- ✅ 数据不会丢失

---

## 📝 需要确认的问题

### 立即需要确认
1. ✅ 用户系统方案 - **已确认: 简单本地用户名**
2. ❓ SM1.02处理方式 - **等待Basel课程标准研究**
3. ❓ 可调节分界线是否需要 - **建议先不做，专注核心问题**

### 后续需要确认
4. ❓ 是否需要专业德语翻译审核
5. ❓ 是否需要教师咨询课程内容
6. ❓ 是否需要添加更多Basel特色内容

---

## 🚀 下一步行动

### 今天（获得批准后）
1. 开始修复模块标题缺失
2. 研究Basel课程标准
3. 修复SM2.02布局问题

### 明天
4. 继续布局改进
5. 开始翻译完善
6. 测试修复效果

---

*创建时间: 2026-02-06*  
*状态: 等待批准*  
*预计完成: 3周*
