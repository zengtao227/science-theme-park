# GM5.01 矩阵几何 - 重新设计方案

## 📊 当前问题分析

### 现有实现的问题:
1. **缺少习题系统** - 只有可视化工具,没有 quest 练习
2. **缺少难度分级** - 没有 BASIC/CORE/ADVANCED/ELITE 系统
3. **缺少场景描述** - 没有巴塞尔工程任务背景
4. **3D可视化过于复杂** - 对初学者不友好
5. **缺少渐进式教学** - 没有从简单到复杂的阶段设计
6. **只支持2x2矩阵** - 特征值计算只处理2x2情况

---

## 🎯 核心知识点 (Gymnasium 线性代数)

### 必须掌握的概念:
1. **矩阵变换的几何意义**
   - 缩放 (Scaling)
   - 旋转 (Rotation)
   - 剪切 (Shear)
   - 反射 (Reflection)

2. **行列式 (Determinant)**
   - 几何意义: 面积/体积缩放因子
   - det(A) = 0 表示降维
   - det(A) < 0 表示方向翻转

3. **矩阵乘法的几何意义**
   - 复合变换
   - 顺序的重要性 (AB ≠ BA)

4. **特征向量和特征值** (高级)
   - 不变方向
   - 缩放因子

---

## 🎨 新设计方案

### 阶段设计 (3个阶段)

#### STAGE 1: BASIC TRANSFORMS (基础变换)
**目标**: 理解单一矩阵变换的几何意义

**可视化**:
- 2D平面 (简化,不用3D)
- 显示单位正方形 [0,1]×[0,1] 的变换
- 显示基向量 i-hat (红色) 和 j-hat (绿色)
- 动画: 从单位矩阵平滑过渡到目标矩阵

**题目类型**:
- 给定变换后的图形,求矩阵
- 给定矩阵,预测变换效果
- 计算行列式,理解面积变化

**难度递进**:
- BASIC: 纯缩放矩阵 [[2,0],[0,3]]
- CORE: 旋转矩阵 (90°, 45°)
- ADVANCED: 剪切矩阵 [[1,k],[0,1]]
- ELITE: 组合变换 (旋转+缩放)

#### STAGE 2: DETERMINANT (行列式)
**目标**: 理解行列式的几何意义

**可视化**:
- 显示单位正方形变换为平行四边形
- 实时显示面积变化
- 颜色编码: det>1(放大,绿色), det<1(缩小,黄色), det<0(翻转,红色)

**题目类型**:
- 给定矩阵,计算行列式
- 给定面积变化,求矩阵参数
- 判断变换是否可逆

**难度递进**:
- BASIC: 对角矩阵 det = a·d
- CORE: 一般2x2矩阵 det = ad-bc
- ADVANCED: 含参数矩阵,求使det=k的参数
- ELITE: 复合变换的行列式 det(AB) = det(A)·det(B)

#### STAGE 3: COMPOSITION (复合变换)
**目标**: 理解矩阵乘法的几何意义

**可视化**:
- 显示两步变换过程
- 先应用矩阵A,再应用矩阵B
- 对比 AB 和 BA 的不同结果

**题目类型**:
- 给定两个变换,计算复合矩阵
- 分解复合变换为基础变换
- 找到逆变换

**难度递进**:
- BASIC: 两个缩放矩阵相乘
- CORE: 旋转+缩放
- ADVANCED: 找到使 AB = I 的矩阵B
- ELITE: 三个矩阵的复合变换

---

## 🏗️ 巴塞尔工程场景

### STAGE 1 场景:
**罗氏制药 - 分子结构分析**
"您在罗氏巴塞尔的计算化学部门工作,使用线性变换分析蛋白质分子的对称性。每个矩阵代表一个对称操作(旋转、反射、缩放)。识别变换类型对于预测分子的光学性质至关重要。"

### STAGE 2 场景:
**诺华制药 - 晶体结构**
"您在诺华巴塞尔分析药物晶体的单元格结构。行列式表示晶格的体积变化。det(A)=0 表示晶体结构坍缩,det(A)<0 表示手性反转。准确计算行列式对于预测药物的生物活性至关重要。"

### STAGE 3 场景:
**巴塞尔大学 - 机器人运动学**
"您在巴塞尔大学机器人实验室编程机械臂。每个关节的运动由一个变换矩阵表示。复合变换 AB 表示先执行关节A的运动,再执行关节B的运动。矩阵乘法的顺序决定了机械臂的最终位置。"

---

## 💻 技术实现方案

### 1. 简化可视化 (2D SVG 替代 3D Three.js)
**原因**:
- 更快的渲染速度
- 更容易理解
- 更精确的标签定位
- 避免3D旋转带来的混淆

**实现**:
```typescript
// 使用 SVG 绘制
- 单位正方形 (虚线)
- 变换后的平行四边形 (实线)
- 基向量箭头
- 网格线
- 数值标签
```

### 2. Quest 系统集成
```typescript
interface MatrixQuest {
  type: "identify" | "calculate" | "predict" | "compose";
  matrix?: number[][];
  matrixA?: number[][];
  matrixB?: number[][];
  targetShape?: Point[];
  question: string;
  answer: number | number[][] | string;
}
```

### 3. 动画系统
- 使用 requestAnimationFrame
- 平滑插值: lerp(identity, target, t)
- 可暂停/重播
- 速度可调

---

## 📝 题目示例

### BASIC - STAGE 1
```
题目: 矩阵 [[2, 0], [0, 2]] 将单位正方形变换为什么图形?
A) 面积为4的正方形
B) 面积为2的正方形  
C) 矩形
D) 平行四边形

答案: A
解释: 这是均匀缩放,边长变为2倍,面积变为4倍
```

### CORE - STAGE 2
```
题目: 计算矩阵 [[3, 1], [2, 4]] 的行列式
输入: ___

答案: 10
解释: det = 3×4 - 1×2 = 12 - 2 = 10
可视化: 单位正方形面积从1变为10
```

### ADVANCED - STAGE 3
```
题目: 先旋转90°,再沿x轴缩放2倍。求复合变换矩阵。
旋转矩阵 R = [[0, -1], [1, 0]]
缩放矩阵 S = [[2, 0], [0, 1]]
求 SR = ?

输入矩阵:
[_][_]
[_][_]

答案: [[0, -2], [1, 0]]
```

---

## ✅ 实施检查清单

- [ ] 创建 MatrixVisualization2D.tsx (SVG组件)
- [ ] 实现 buildMatrixPool() 函数
- [ ] 添加3个阶段的题目池 (每个难度4-5题)
- [ ] 集成 useQuestManager hook
- [ ] 添加巴塞尔场景描述 (EN/CN/DE)
- [ ] 实现动画系统
- [ ] 添加行列式实时计算显示
- [ ] 测试所有难度级别
- [ ] 验证标签不重叠
- [ ] 浏览器测试 (EN/CN/DE)
- [ ] 推送到 GitHub

---

## 🎓 教学目标

学生完成GM5.01后应该能够:
1. ✅ 识别基础矩阵变换的几何意义
2. ✅ 计算2x2矩阵的行列式
3. ✅ 理解行列式的几何意义(面积缩放)
4. ✅ 计算矩阵乘法并理解复合变换
5. ✅ 理解矩阵乘法的顺序重要性
6. ✅ 将抽象的矩阵运算与具体的几何变换联系起来
