# WORKFLOW_PROTOCOL v2.2 (2026-01-29)

## 🚨 核心原则 (Core Tenets)

### 1. Git 恢复优先 (Git Restore First)
- **绝对禁止盲目重写**。如果一个模块功能异常或曾经被删除，**第一步** 永远是使用 `git restore [file]` 从最近的成功提交中找回文件。
- 只有在原有逻辑无法支持新架构时才进行重构，且必须保留核心算法。

### 2. 第一性原理分析 (The Framework)
在提出任何方案前，必须明确：
- **问题本质**：为什么需要这个功能？
- **现有机制**：系统中是否有现成组件可选？
### 3. 最小化改动 (Minimal Change)
- 最好的代码就是不写代码。

### 4. 逻辑先行 + 英语优先 (Logic First & English Priority)
- **拒绝同步翻译陷阱**：在模块的逻辑开发阶段（物理模拟、数学题库），**仅更新 `i18n.ts` 的 EN 字典**。
- **占位符策略**：CN 和 DE 的翻译应直接复制 EN 的内容，直到该模块通过功能验收。
- **批量翻译**：待模块功能 100% 完成后，再进行一次性的多语言补全，避免在琐碎的翻译同步上消耗开发时间。

---

## 🎨 UI/UX 标准 (Design Standards)

### Header 全局标准
- **高度**：`h-20` (80px)。
- **标题**：必须 `absolute` 居中，字号 `text-lg` 至 `text-xl`。
- **左侧**：统一的 `Back` 按钮。
- **右上角**：
    - **语言切换**：顺序固定为 `DE -> EN -> CN`。
    - **样式**：未选中按钮为白色 (`text-white`) + 边框 (`border-white/30`)。选中按钮为白底黑字。

---

## 🏗️ 题目设计范式 (Quest Paradigms)

### MISSION (生活化应用) 注入规范
每个模块在完成技术练习后，必须增加一个 `MISSION` 环节：
1. **真实性**：场景必须基于瑞士本土（苏黎世、伯尔尼、巴塞尔等）。
2. **渐进性**：难度从 BASIC -> MISSION。学生通过基础练习后，才能解锁“实战任务”。
3. **i18n 完整性**：必须在 `i18n.ts` 中定义的 `mission` 物体内配置场景描述文本。

---

## ⚙️ 路由协议 (AI Routing)
- ** Gemini** 负责“写代码”和“工程落地”。
- ** NVIDIA GLM/DeepSeek** 负责“数学推导”和“真理性校验”。
- 每次涉及复杂数学计算（如 M-G09），必须先调用数学模型获取演算步骤。
