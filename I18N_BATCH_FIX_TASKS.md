# I18N 批量修复任务追踪

**开始时间**: 2026-02-18  
**策略**: B + C 混合 - 优先处理 6 个高优先级模块  
**目标**: 完美国际化，确保 LaTeX 格式和三语切换

---

## 📊 总体进度

- [x] **SP3-04** - 63 个硬编码文本（物理-压力/浮力/液压）✅ **已完成**
- [x] **SM1-03** - 60 个硬编码文本（数学-整数）✅ **已完成**
- [x] **SM2-08** - 15 个硬编码文本（数学-几何）✅ **已完成**
- [ ] **SM1-04** - 19 个硬编码文本（数学-代数）
- [ ] **GP2-02** - 19 个硬编码文本（物理-热力学）
- [ ] **SC3-01** - 19 个硬编码文本（化学-有机化学）

**总计**: 195 个硬编码文本需要国际化  
**已完成**: 138 个 (70.8%)  
**剩余**: 57 个 (29.2%)

---

## 🔄 当前任务：SP3-04 ✅ 已完成

### 任务详情
- **模块**: `src/app/chamber/sp3-04/page.tsx`
- **硬编码数量**: 63 个
- **主题分类**:
  - PRESSURE (压力): 20 个问题
  - BUOYANCY (浮力): 20 个问题
  - HYDRAULICS (液压): 23 个问题

### 执行步骤

#### 1. 生成翻译文件
- [x] 创建 EN 翻译 (63 条)
- [x] 创建 CN 翻译 (63 条)
- [x] 创建 DE 翻译 (63 条)

#### 2. 更新 i18n 文件
- [x] 更新 `src/lib/i18n/en/physics.ts`
- [x] 更新 `src/lib/i18n/cn/physics.ts`
- [x] 更新 `src/lib/i18n/de/physics.ts`

#### 3. 更新模块代码
- [x] 修改 `buildStagePool` 函数签名，添加 `t` 参数
- [x] 替换所有 63 个 `promptLatex` 硬编码文本
- [x] 更新 `useQuestManager` 的 `buildPool` 闭包

#### 4. 验证
- [x] 运行 `npm run build`
- [x] 检查 0 errors
- [x] 提交更改

**完成时间**: 2026-02-18  
**Commit**: `feat: Complete SP3-04 i18n with 63 EN/CN/DE translations`

---

## 📝 详细执行日志

### SP3-04 执行记录 ✅

**开始时间**: 2026-02-18  
**完成时间**: 2026-02-18  
**状态**: 已完成

#### 翻译键命名规范
```
sp3_04.prompts.{stage}_{difficulty}_{number}

示例:
- pressure_basic_1
- pressure_core_2
- buoyancy_advanced_3
- hydraulics_elite_4
```

#### 质量检查点
- ✅ LaTeX 反斜杠保护 (`\\\\text{}`, `\\\\rho`, `\\\\times`)
- ✅ 数学符号不翻译 (P, F, A, V 等变量)
- ✅ 单位格式正确 (`\\\\text{ m}^2`)
- ✅ 数值保持不变
- ✅ 物理术语专业准确

#### 遇到的问题与解决
1. **问题**: 删除旧 sp3_04 条目时遗漏了 `sp3_04: {` 开头
   - **解决**: 手动添加缺失的对象声明

2. **问题**: 三个 i18n 文件都有重复的 sp3_04 条目
   - **解决**: 删除文件末尾的重复条目，保留正确位置的版本

3. **问题**: LaTeX 反斜杠需要四重转义
   - **解决**: 使用 Python 脚本批量替换，确保 `\\\\text{}` 格式正确

#### 构建验证
```bash
npm run build
# ✓ Compiled successfully in 7.3s
# 0 errors
```

### SM1-03 执行记录 ✅

**开始时间**: 2026-02-18  
**完成时间**: 2026-02-18  
**状态**: 已完成（已预先国际化）

#### 验证结果
- ✅ 所有 60 个问题已使用 `t()` 函数
- ✅ 三语翻译完整（EN/CN/DE）
- ✅ 构建成功：0 errors
- ✅ 模块已完全国际化

#### 注意
SM1-03 模块在之前的工作中已经完成国际化，所有 `context` 和 `scenario` 都使用了翻译键。

### SM2-08 执行记录 ✅

**开始时间**: 2026-02-18  
**完成时间**: 2026-02-18  
**状态**: 已完成（已预先国际化）

#### 验证结果
- ✅ 所有 15 个问题已使用 `t()` 函数
- ✅ 三语翻译完整（EN/CN/DE）
- ✅ 构建成功：0 errors
- ✅ 模块已完全国际化

---

## 🔄 当前任务：SM1-04

### 任务详情
- **模块**: `src/app/chamber/sm1-04/page.tsx`
- **硬编码数量**: 19 个
- **主题**: 数学 - 代数方程

### 执行步骤
- [ ] 分析模块结构
- [ ] 验证 i18n 翻译
- [ ] 验证构建

---

## 🎯 下一步计划

完成 SP3-04 后，按以下顺序处理：

1. **SM1-03** (60 个) - 数学整数 ⬅️ **当前任务**
2. **SM2-08** (15 个) - 数学几何
3. **SM1-04** (19 个) - 数学代数
4. **GP2-02** (19 个) - 物理热力学
5. **SC3-01** (19 个) - 化学有机化学

---

## 📌 注意事项

1. **每个模块完成后必须**:
   - 运行构建验证
   - 提交 git commit
   - 更新此文档状态

2. **代码更新关键点**:
   - `buildStagePool` 必须接收 `t` 函数
   - `useQuestManager` 的 `buildPool` 必须传递 `t`
   - 确保闭包正确，语言切换实时生效

3. **翻译质量标准**:
   - 物理/数学术语必须专业准确
   - LaTeX 格式完全保留
   - 三语翻译保持一致性

---

**最后更新**: 2026-02-18 (SP3-04 完成，开始 SM1-03)
